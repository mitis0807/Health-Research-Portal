(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=d(n(0)),l=n(21),s=n(36),r=d(n(29)),i=d(n(197)),c=d(n(46));function d(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}n(37);var m=l.Modal.error,f=void 0,h=[{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Name")),dataIndex:"name",key:"name",ellipsis:!0},{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Email")),dataIndex:"email",key:"email",ellipsis:!0},{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Action")),dataIndex:"action",key:"action"}],p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.start=function(){setTimeout((function(){n.setState({})}),1e3)},n.state={data:[],addedMembers:[],members:[],originalData:[],committeeMembers:[],committeeLength:"",keyLength:"",disabledButton:!1},f=n,n.handleAddCommittee=n.handleAddCommittee.bind(n),n.handleButtonClick=n.handleButtonClick.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this;console.log("in component did mount add member"),fetch(r.default.APIURL+"/getAllInternalReviewer",{headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},credentials:"include"}).then((function(e){return e.json()})).then((function(t){200===t.status?e.setState({data:t.internalReviewerData,originalData:t.internalReviewerData}):300===t.status?s.toast.error(t.message,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}):401===t.status?m({title:c.default.SessionExpired+t.message,content:"",onOk:function(){f.props.history.push("/signIn")}}):500===t.status?e.props.history.push("/serverError"):400===t.status?e.props.history.push("/badRequest"):403===t.status&&e.props.history.push("/forbiddenRequest")})),fetch(r.default.APIURL+"/getAllCommitteeMember",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},credentials:"include"}).then((function(e){return e.json()})).then((function(t){200===t.status?e.setState({committeeMembers:t.committeeMemberData,committeeLength:t.committeeMemberData.length}):300===t.status?s.toast.error(t.message,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}):500===t.status?e.props.history.push("/serverError"):400===t.status?e.props.history.push("/badRequest"):403===t.status&&e.props.history.push("/forbiddenRequest")}))}},{key:"handleCheckBoxClick",value:function(e,t){console.log("in handleCheckBoxClick"),console.log("key1"),console.log(e),console.log("index"),console.log(t),console.log("addedMembers"),console.log(this.state.addedMembers),this.setState({disabledButton:!1});var n=this.state.addedMembers,o="ref_"+t;if(this.refs[o].checked=!this.refs[o].checked,!1===this.refs[o].checked){var a=n.filter((function(t){return console.log("member========"),console.log(t),console.log(e),t!==e}));console.log("in ressssssssssssss"),console.log(a),this.setState({addedMembers:a})}else!0===this.refs[o].checked&&this.setState({addedMembers:[].concat(u(this.state.addedMembers),[e])},(function(){}))}},{key:"handle",value:function(){return[{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement(l.Button,{onClick:this.handleButtonClick,style:{marginBottom:"0px"},type:"primary"},"Add")),dataIndex:"add",key:"add"},{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Name")),dataIndex:"name",key:"name"},{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Email")),dataIndex:"email",key:"email"},{title:a.default.createElement("div",{style:{fontSize:14}},a.default.createElement("b",null,"Expertise")),dataIndex:"expertise",key:"expertise"}].map((function(e,t){return{title:e.title,dataIndex:e.dataIndex,key:e.key}}))}},{key:"handleButtonClick",value:function(){var e=this.state,t=e.data,n=e.addedMembers,o=e.members,a=e.committeeLength,l=e.keyLength;console.log("**************************"),console.log(t),console.log(n),console.log(o),console.log(a),console.log(l);var r=10-a-l,i=10-a-n.length;if(console.log("=============================="),console.log(r),console.log(i),i<0)0===r?s.toast.error(c.default.CommitteeLengthLimit,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}):0!==r&&s.toast.error(c.default.ErrorLengthOfCommittee1+r+c.default.ErrorLengthOfCommittee2,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1});else if(i>=0){var d=t.filter((function(e){return n.includes(e.id)}));o.push(d);var u=t.filter((function(e){return!n.includes(e.id)}));this.setState({members:o,data:u,keyLength:n.length})}}},{key:"handleRemoveClick",value:function(e){console.log("****handleRemoveClick*******");var t=this.state,n=t.members,o=t.data,a=t.originalData,l=t.keyLength;console.log(n),console.log(o),console.log(a),console.log(l),console.log(e);var s=n.flatMap((function(e){return e}));console.log("memberToRemove"),console.log(s);var r=s.filter((function(t){return!e.includes(t.id)}));console.log("removeSelectedMember"),console.log(r);var i=a.filter((function(t){return e.includes(t.id)}));console.log("addUnselectedMemberToMainTable"),console.log(i);var c=l-i.length;console.log("afterDeleteKeys"),console.log(l),console.log(c),o.push(i);var d=o.flatMap((function(e){return e}));this.setState({members:r,data:d,addedMembers:r,keyLength:c})}},{key:"dataFromAboveDataTable",value:function(){var e=this;return this.state.members.flatMap((function(e){return e})).map((function(t,n){return{key:n,name:t.firstName+" "+t.lastName,email:t.email,status:t.status,action:a.default.createElement(l.Tooltip,{placement:"top",title:"Remove"},a.default.createElement(l.Icon,{onClick:function(){return e.handleRemoveClick(t.id)},style:{marginRight:"15px",fontSize:"17px",color:"red"},type:"close-circle"}))}}))}},{key:"handleAddCommittee",value:function(){var e=this;this.state.disabledButton=!0,this.setState({disabledButton:!0});var t=this.state.members;console.log("members in handleAddCommittee"),console.log(t.length),console.log(n);for(var n=[],o=t.flatMap((function(e){return e})),a=0;a<o.length;a+=1)n.push(o[a].id);t.length>0?fetch(r.default.APIURL+"/addCommittee",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},credentials:"include",body:JSON.stringify({internalUserIds:n})}).then((function(e){return e.json()})).then((function(t){200===t.status?(s.toast.success(t.message,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}),e.setState({internalUserData:t.internalUserData}),e.props.history.push("/manageCommittee")):300===t.status?s.toast.error(t.message,{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}):401===t.status&&m({title:"Session expired."+t.message,content:"",onOk:function(){f.props.history.push("/signIn")}})})):(s.toast.error("No members are added in the list",{position:"top-center",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}),this.setState({disabledButton:!0}))}},{key:"renderTableData",value:function(){for(var e=this,t=this.state,n=t.data,o=t.committeeMembers,s=[],r=o.flatMap((function(e){return e})),i=0;i<r.length;i+=1)s.push(r[i].id);return n.filter((function(e){return!s.includes(e.id)})).map((function(t,n){return{key:t.id,name:t.firstName+" "+t.lastName,email:t.email,expertise:void 0===t.expertise?a.default.createElement("span",null,"N/A"):t.expertise,add:a.default.createElement(l.Checkbox,{ref:"ref_"+n,onClick:function(){return e.handleCheckBoxClick(t.id,n)}})}}))}},{key:"render",value:function(){return console.log("render"),console.log(this.state.addedMembers),console.log(this.state.committeeLength),console.log(this.state.keyLength),document.title="  Add Member | "+c.default.PageTitle,a.default.createElement("div",null,a.default.createElement(i.default,{propertyProps:this.props}),a.default.createElement(l.Card,{className:"cardcss",title:"Eligible Users"},a.default.createElement("div",{className:"gx-mb-3"}),a.default.createElement(l.Table,{className:"gx-table-responsive",columns:this.handle(),dataSource:this.renderTableData()})),a.default.createElement(l.Card,{className:"cardcss",title:"Added Members",extra:a.default.createElement("span",null,"Number of members to be added :",a.default.createElement("b",null,10-this.state.committeeLength-this.state.keyLength))},a.default.createElement(l.Table,{className:"gx-table-responsive",columns:h,dataSource:this.dataFromAboveDataTable(),pagination:!1}),a.default.createElement("br",null),a.default.createElement(l.Button,{type:"primary",disabled:this.state.disabledButton,onClick:this.handleAddCommittee},"Add Committee Member(s)")))}}]),t}(a.default.Component);t.default=p}}]);